<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.youthloop.game.persistence.mapper.GameRuleConfigMapper">

    <resultMap id="EventRuleResultMap" type="com.youthloop.game.persistence.entity.GameEventRuleConfigEntity">
        <id column="event_type" property="eventType" jdbcType="VARCHAR"/>
        <result column="trigger_probability_pct" property="triggerProbabilityPct" jdbcType="INTEGER"/>
        <result column="min_green" property="minGreen" jdbcType="INTEGER"/>
        <result column="min_carbon" property="minCarbon" jdbcType="INTEGER"/>
        <result column="max_satisfaction" property="maxSatisfaction" jdbcType="INTEGER"/>
        <result column="min_population" property="minPopulation" jdbcType="INTEGER"/>
        <result column="require_even_turn" property="requireEvenTurn" jdbcType="BOOLEAN"/>
        <result column="weight" property="weight" jdbcType="INTEGER"/>
        <result column="duration_turns" property="durationTurns" jdbcType="INTEGER"/>
        <result column="green_delta" property="greenDelta" jdbcType="INTEGER"/>
        <result column="carbon_delta" property="carbonDelta" jdbcType="INTEGER"/>
        <result column="satisfaction_delta" property="satisfactionDelta" jdbcType="INTEGER"/>
        <result column="green_pct_delta" property="greenPctDelta" jdbcType="INTEGER"/>
        <result column="population_pct_delta" property="populationPctDelta" jdbcType="INTEGER"/>
        <result column="quota_delta" property="quotaDelta" jdbcType="INTEGER"/>
        <result column="display_name" property="displayName" jdbcType="VARCHAR"/>
        <result column="effect_summary" property="effectSummary" jdbcType="VARCHAR"/>
        <result column="resolution_hint" property="resolutionHint" jdbcType="VARCHAR"/>
        <result column="resolvable_policy_ids_csv" property="resolvablePolicyIdsCsv" jdbcType="VARCHAR"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="ComboRuleResultMap" type="com.youthloop.game.persistence.entity.GameComboRuleConfigEntity">
        <id column="combo_id" property="comboId" jdbcType="VARCHAR"/>
        <result column="priority_order" property="priorityOrder" jdbcType="INTEGER"/>
        <result column="required_policy_id" property="requiredPolicyId" jdbcType="VARCHAR"/>
        <result column="min_industry" property="minIndustry" jdbcType="INTEGER"/>
        <result column="min_ecology" property="minEcology" jdbcType="INTEGER"/>
        <result column="min_science" property="minScience" jdbcType="INTEGER"/>
        <result column="min_society" property="minSociety" jdbcType="INTEGER"/>
        <result column="min_low_carbon_industry" property="minLowCarbonIndustry" jdbcType="INTEGER"/>
        <result column="min_shenzhen_ecology" property="minShenzhenEcology" jdbcType="INTEGER"/>
        <result column="min_link_cards" property="minLinkCards" jdbcType="INTEGER"/>
        <result column="min_industry_low_carbon_adjacent_pairs" property="minIndustryLowCarbonAdjacentPairs" jdbcType="INTEGER"/>
        <result column="min_science_science_adjacent_pairs" property="minScienceScienceAdjacentPairs" jdbcType="INTEGER"/>
        <result column="min_science_industry_adjacent_pairs" property="minScienceIndustryAdjacentPairs" jdbcType="INTEGER"/>
        <result column="min_industry_ecology_adjacent_pairs" property="minIndustryEcologyAdjacentPairs" jdbcType="INTEGER"/>
        <result column="min_society_ecology_adjacent_pairs" property="minSocietyEcologyAdjacentPairs" jdbcType="INTEGER"/>
        <result column="effect_industry_delta" property="effectIndustryDelta" jdbcType="INTEGER"/>
        <result column="effect_tech_delta" property="effectTechDelta" jdbcType="INTEGER"/>
        <result column="effect_population_delta" property="effectPopulationDelta" jdbcType="INTEGER"/>
        <result column="effect_green_delta" property="effectGreenDelta" jdbcType="INTEGER"/>
        <result column="effect_carbon_delta" property="effectCarbonDelta" jdbcType="INTEGER"/>
        <result column="effect_satisfaction_delta" property="effectSatisfactionDelta" jdbcType="INTEGER"/>
        <result column="effect_quota_delta" property="effectQuotaDelta" jdbcType="INTEGER"/>
        <result column="effect_low_carbon_delta" property="effectLowCarbonDelta" jdbcType="INTEGER"/>
        <result column="effect_tech_pct" property="effectTechPct" jdbcType="INTEGER"/>
        <result column="effect_population_pct" property="effectPopulationPct" jdbcType="INTEGER"/>
        <result column="effect_industry_pct" property="effectIndustryPct" jdbcType="INTEGER"/>
        <result column="effect_low_carbon_pct" property="effectLowCarbonPct" jdbcType="INTEGER"/>
        <result column="effect_green_pct" property="effectGreenPct" jdbcType="INTEGER"/>
        <result column="effect_global_pct" property="effectGlobalPct" jdbcType="INTEGER"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="CardTagResultMap" type="com.youthloop.game.persistence.entity.GameCardTagMapEntity">
        <id column="card_id" property="cardId" jdbcType="VARCHAR"/>
        <id column="tag_code" property="tagCode" jdbcType="VARCHAR"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="PolicyUnlockRuleResultMap" type="com.youthloop.game.persistence.entity.GamePolicyUnlockRuleConfigEntity">
        <id column="policy_id" property="policyId" jdbcType="VARCHAR"/>
        <result column="priority_order" property="priorityOrder" jdbcType="INTEGER"/>
        <result column="min_industry" property="minIndustry" jdbcType="INTEGER"/>
        <result column="min_ecology" property="minEcology" jdbcType="INTEGER"/>
        <result column="min_science" property="minScience" jdbcType="INTEGER"/>
        <result column="min_society" property="minSociety" jdbcType="INTEGER"/>
        <result column="min_industry_resource" property="minIndustryResource" jdbcType="INTEGER"/>
        <result column="min_tech_resource" property="minTechResource" jdbcType="INTEGER"/>
        <result column="min_population_resource" property="minPopulationResource" jdbcType="INTEGER"/>
        <result column="min_green" property="minGreen" jdbcType="INTEGER"/>
        <result column="min_carbon" property="minCarbon" jdbcType="INTEGER"/>
        <result column="max_carbon" property="maxCarbon" jdbcType="INTEGER"/>
        <result column="min_satisfaction" property="minSatisfaction" jdbcType="INTEGER"/>
        <result column="min_tagged_cards" property="minTaggedCards" jdbcType="INTEGER"/>
        <result column="required_tag" property="requiredTag" jdbcType="VARCHAR"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="CoreSpecialConditionResultMap" type="com.youthloop.game.persistence.entity.GameCoreSpecialConditionConfigEntity">
        <id column="card_id" property="cardId" jdbcType="VARCHAR"/>
        <result column="required_event_type" property="requiredEventType" jdbcType="VARCHAR"/>
        <result column="min_industry_cards" property="minIndustryCards" jdbcType="INTEGER"/>
        <result column="min_ecology_cards" property="minEcologyCards" jdbcType="INTEGER"/>
        <result column="min_science_cards" property="minScienceCards" jdbcType="INTEGER"/>
        <result column="min_society_cards" property="minSocietyCards" jdbcType="INTEGER"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="RuntimeParamResultMap" type="com.youthloop.game.persistence.entity.GameRuntimeParamConfigEntity">
        <id column="config_id" property="configId" jdbcType="INTEGER"/>
        <result column="core_hand_limit" property="coreHandLimit" jdbcType="INTEGER"/>
        <result column="policy_hand_limit" property="policyHandLimit" jdbcType="INTEGER"/>
        <result column="max_combo_per_turn" property="maxComboPerTurn" jdbcType="INTEGER"/>
        <result column="max_turn" property="maxTurn" jdbcType="INTEGER"/>
        <result column="trade_window_interval" property="tradeWindowInterval" jdbcType="INTEGER"/>
        <result column="base_carbon_price" property="baseCarbonPrice" jdbcType="DOUBLE"/>
        <result column="max_carbon_quota" property="maxCarbonQuota" jdbcType="INTEGER"/>
        <result column="domain_progress_card_cap" property="domainProgressCardCap" jdbcType="INTEGER"/>
        <result column="ending_display_seconds" property="endingDisplaySeconds" jdbcType="INTEGER"/>
        <result column="turn_transition_animation_enabled_default" property="turnTransitionAnimationEnabledDefault" jdbcType="BOOLEAN"/>
        <result column="turn_transition_animation_seconds" property="turnTransitionAnimationSeconds" jdbcType="INTEGER"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="BalanceRuleResultMap" type="com.youthloop.game.persistence.entity.GameBalanceRuleConfigEntity">
        <id column="config_id" property="configId" jdbcType="INTEGER"/>
        <result column="initial_phase" property="initialPhase" jdbcType="VARCHAR"/>
        <result column="initial_event_cooldown" property="initialEventCooldown" jdbcType="INTEGER"/>
        <result column="board_size" property="boardSize" jdbcType="INTEGER"/>
        <result column="initial_industry" property="initialIndustry" jdbcType="INTEGER"/>
        <result column="initial_tech" property="initialTech" jdbcType="INTEGER"/>
        <result column="initial_population" property="initialPopulation" jdbcType="INTEGER"/>
        <result column="initial_green" property="initialGreen" jdbcType="INTEGER"/>
        <result column="initial_carbon" property="initialCarbon" jdbcType="INTEGER"/>
        <result column="initial_satisfaction" property="initialSatisfaction" jdbcType="INTEGER"/>
        <result column="initial_low_carbon_score" property="initialLowCarbonScore" jdbcType="INTEGER"/>
        <result column="initial_quota" property="initialQuota" jdbcType="INTEGER"/>
        <result column="initial_draw_early" property="initialDrawEarly" jdbcType="INTEGER"/>
        <result column="draw_count_early" property="drawCountEarly" jdbcType="INTEGER"/>
        <result column="draw_count_mid" property="drawCountMid" jdbcType="INTEGER"/>
        <result column="draw_count_late" property="drawCountLate" jdbcType="INTEGER"/>
        <result column="event_cooldown_reset_turns" property="eventCooldownResetTurns" jdbcType="INTEGER"/>
        <result column="settlement_base_industry_gain" property="settlementBaseIndustryGain" jdbcType="INTEGER"/>
        <result column="settlement_base_tech_gain" property="settlementBaseTechGain" jdbcType="INTEGER"/>
        <result column="settlement_base_population_gain" property="settlementBasePopulationGain" jdbcType="INTEGER"/>
        <result column="satisfaction_max" property="satisfactionMax" jdbcType="INTEGER"/>
        <result column="carbon_quota_base_line" property="carbonQuotaBaseLine" jdbcType="INTEGER"/>
        <result column="carbon_quota_per_n_over" property="carbonQuotaPerNOver" jdbcType="INTEGER"/>
        <result column="carbon_industry_emission_per_card" property="carbonIndustryEmissionPerCard" jdbcType="INTEGER"/>
        <result column="carbon_ecology_reduction_per_card" property="carbonEcologyReductionPerCard" jdbcType="INTEGER"/>
        <result column="carbon_science_reduction_per_card" property="carbonScienceReductionPerCard" jdbcType="INTEGER"/>
        <result column="trade_random_base_min" property="tradeRandomBaseMin" jdbcType="DOUBLE"/>
        <result column="trade_random_span" property="tradeRandomSpan" jdbcType="DOUBLE"/>
        <result column="trade_high_carbon_threshold" property="tradeHighCarbonThreshold" jdbcType="INTEGER"/>
        <result column="trade_high_carbon_factor" property="tradeHighCarbonFactor" jdbcType="DOUBLE"/>
        <result column="trade_low_carbon_threshold" property="tradeLowCarbonThreshold" jdbcType="INTEGER"/>
        <result column="trade_low_carbon_factor" property="tradeLowCarbonFactor" jdbcType="DOUBLE"/>
        <result column="failure_high_carbon_threshold" property="failureHighCarbonThreshold" jdbcType="INTEGER"/>
        <result column="failure_high_carbon_streak_limit" property="failureHighCarbonStreakLimit" jdbcType="INTEGER"/>
        <result column="trade_failure_quota_exhausted_limit" property="tradeFailureQuotaExhaustedLimit" jdbcType="INTEGER"/>
        <result column="trade_failure_profit_threshold" property="tradeFailureProfitThreshold" jdbcType="DOUBLE"/>
        <result column="low_carbon_min_for_positive_ending" property="lowCarbonMinForPositiveEnding" jdbcType="INTEGER"/>
        <result column="low_carbon_domain_threshold" property="lowCarbonDomainThreshold" jdbcType="INTEGER"/>
        <result column="low_carbon_domain_bonus" property="lowCarbonDomainBonus" jdbcType="INTEGER"/>
        <result column="low_carbon_policy_unlock_score" property="lowCarbonPolicyUnlockScore" jdbcType="INTEGER"/>
        <result column="low_carbon_policy_unlock_all_count" property="lowCarbonPolicyUnlockAllCount" jdbcType="INTEGER"/>
        <result column="low_carbon_policy_unlock_all_bonus" property="lowCarbonPolicyUnlockAllBonus" jdbcType="INTEGER"/>
        <result column="low_carbon_event_resolved_score" property="lowCarbonEventResolvedScore" jdbcType="INTEGER"/>
        <result column="low_carbon_event_triggered_penalty" property="lowCarbonEventTriggeredPenalty" jdbcType="INTEGER"/>
        <result column="low_carbon_over_limit_carbon_threshold" property="lowCarbonOverLimitCarbonThreshold" jdbcType="INTEGER"/>
        <result column="low_carbon_over_limit_streak_threshold" property="lowCarbonOverLimitStreakThreshold" jdbcType="INTEGER"/>
        <result column="low_carbon_over_limit_streak_penalty" property="lowCarbonOverLimitStreakPenalty" jdbcType="INTEGER"/>
        <result column="low_carbon_trade_profit_divisor" property="lowCarbonTradeProfitDivisor" jdbcType="DOUBLE"/>
        <result column="low_carbon_trade_profit_bonus" property="lowCarbonTradeProfitBonus" jdbcType="INTEGER"/>
        <result column="low_carbon_quota_exhausted_penalty" property="lowCarbonQuotaExhaustedPenalty" jdbcType="INTEGER"/>
        <result column="low_carbon_invalid_operation_penalty" property="lowCarbonInvalidOperationPenalty" jdbcType="INTEGER"/>
        <result column="carbon_tier_1_max" property="carbonTier1Max" jdbcType="INTEGER"/>
        <result column="carbon_tier_1_score" property="carbonTier1Score" jdbcType="INTEGER"/>
        <result column="carbon_tier_2_max" property="carbonTier2Max" jdbcType="INTEGER"/>
        <result column="carbon_tier_2_score" property="carbonTier2Score" jdbcType="INTEGER"/>
        <result column="carbon_tier_3_max" property="carbonTier3Max" jdbcType="INTEGER"/>
        <result column="carbon_tier_3_score" property="carbonTier3Score" jdbcType="INTEGER"/>
        <result column="carbon_tier_4_max" property="carbonTier4Max" jdbcType="INTEGER"/>
        <result column="carbon_tier_4_score" property="carbonTier4Score" jdbcType="INTEGER"/>
        <result column="carbon_tier_5_score" property="carbonTier5Score" jdbcType="INTEGER"/>
        <result column="phase_early_max_cards" property="phaseEarlyMaxCards" jdbcType="INTEGER"/>
        <result column="phase_early_max_score" property="phaseEarlyMaxScore" jdbcType="INTEGER"/>
        <result column="phase_mid_min_cards" property="phaseMidMinCards" jdbcType="INTEGER"/>
        <result column="phase_mid_max_cards" property="phaseMidMaxCards" jdbcType="INTEGER"/>
        <result column="phase_mid_min_score" property="phaseMidMinScore" jdbcType="INTEGER"/>
        <result column="phase_mid_max_score" property="phaseMidMaxScore" jdbcType="INTEGER"/>
        <result column="phase_late_min_cards" property="phaseLateMinCards" jdbcType="INTEGER"/>
        <result column="phase_late_min_score" property="phaseLateMinScore" jdbcType="INTEGER"/>
        <result column="phase_late_remaining_cards_threshold" property="phaseLateRemainingCardsThreshold" jdbcType="INTEGER"/>
        <result column="ending_event_resolve_rate_required" property="endingEventResolveRateRequired" jdbcType="DOUBLE"/>
        <result column="ending_innovation_min_science" property="endingInnovationMinScience" jdbcType="INTEGER"/>
        <result column="ending_innovation_min_tech" property="endingInnovationMinTech" jdbcType="INTEGER"/>
        <result column="ending_innovation_min_low_carbon" property="endingInnovationMinLowCarbon" jdbcType="INTEGER"/>
        <result column="ending_innovation_max_carbon" property="endingInnovationMaxCarbon" jdbcType="INTEGER"/>
        <result column="ending_innovation_min_profit" property="endingInnovationMinProfit" jdbcType="DOUBLE"/>
        <result column="ending_ecology_min_ecology" property="endingEcologyMinEcology" jdbcType="INTEGER"/>
        <result column="ending_ecology_min_green" property="endingEcologyMinGreen" jdbcType="INTEGER"/>
        <result column="ending_ecology_min_low_carbon" property="endingEcologyMinLowCarbon" jdbcType="INTEGER"/>
        <result column="ending_ecology_max_carbon" property="endingEcologyMaxCarbon" jdbcType="INTEGER"/>
        <result column="ending_ecology_min_quota" property="endingEcologyMinQuota" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_society" property="endingDoughnutMinSociety" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_satisfaction" property="endingDoughnutMinSatisfaction" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_population" property="endingDoughnutMinPopulation" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_domain" property="endingDoughnutMinDomain" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_low_carbon" property="endingDoughnutMinLowCarbon" jdbcType="INTEGER"/>
        <result column="ending_doughnut_max_carbon" property="endingDoughnutMaxCarbon" jdbcType="INTEGER"/>
        <result column="ending_doughnut_min_policy_usage_6768" property="endingDoughnutMinPolicyUsage6768" jdbcType="INTEGER"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <resultMap id="EndingContentResultMap" type="com.youthloop.game.persistence.entity.GameEndingContentConfigEntity">
        <id column="ending_id" property="endingId" jdbcType="VARCHAR"/>
        <result column="ending_name" property="endingName" jdbcType="VARCHAR"/>
        <result column="image_key" property="imageKey" jdbcType="VARCHAR"/>
        <result column="default_reason" property="defaultReason" jdbcType="VARCHAR"/>
        <result column="failure_reason_high_carbon" property="failureReasonHighCarbon" jdbcType="VARCHAR"/>
        <result column="failure_reason_trade" property="failureReasonTrade" jdbcType="VARCHAR"/>
        <result column="failure_reason_low_score" property="failureReasonLowScore" jdbcType="VARCHAR"/>
        <result column="failure_reason_boundary_default" property="failureReasonBoundaryDefault" jdbcType="VARCHAR"/>
        <result column="is_enabled" property="isEnabled" jdbcType="BOOLEAN"/>
    </resultMap>

    <select id="selectEnabledEventRules" resultMap="EventRuleResultMap">
        SELECT event_type, trigger_probability_pct, min_green, min_carbon, max_satisfaction, min_population, require_even_turn,
               weight, duration_turns, green_delta, carbon_delta, satisfaction_delta, green_pct_delta, population_pct_delta,
               quota_delta, display_name, effect_summary, resolution_hint, resolvable_policy_ids_csv, is_enabled
        FROM game.game_event_rule_config
        WHERE is_enabled = TRUE
        ORDER BY event_type ASC
    </select>

    <select id="selectEnabledComboRules" resultMap="ComboRuleResultMap">
        SELECT combo_id, priority_order, required_policy_id, min_industry, min_ecology, min_science, min_society,
               min_low_carbon_industry, min_shenzhen_ecology, min_link_cards, min_industry_low_carbon_adjacent_pairs,
               min_science_science_adjacent_pairs, min_science_industry_adjacent_pairs, min_industry_ecology_adjacent_pairs,
               min_society_ecology_adjacent_pairs, effect_industry_delta, effect_tech_delta, effect_population_delta,
               effect_green_delta, effect_carbon_delta, effect_satisfaction_delta, effect_quota_delta, effect_low_carbon_delta,
               effect_tech_pct, effect_population_pct, effect_industry_pct, effect_low_carbon_pct, effect_green_pct,
               effect_global_pct, is_enabled
        FROM game.game_combo_rule_config
        WHERE is_enabled = TRUE
        ORDER BY priority_order ASC, combo_id ASC
    </select>

    <select id="selectEnabledCardTags" resultMap="CardTagResultMap">
        SELECT card_id, tag_code, is_enabled
        FROM game.game_card_tag_map
        WHERE is_enabled = TRUE
        ORDER BY tag_code ASC, card_id ASC
    </select>

    <select id="selectEnabledPolicyUnlockRules" resultMap="PolicyUnlockRuleResultMap">
        SELECT policy_id, priority_order, min_industry, min_ecology, min_science, min_society,
               min_industry_resource, min_tech_resource, min_population_resource,
               min_green, min_carbon, max_carbon, min_satisfaction,
               min_tagged_cards, required_tag, is_enabled
        FROM game.game_policy_unlock_rule_config
        WHERE is_enabled = TRUE
        ORDER BY priority_order ASC, policy_id ASC
    </select>

    <select id="selectEnabledCoreSpecialConditions" resultMap="CoreSpecialConditionResultMap">
        SELECT card_id, required_event_type, min_industry_cards, min_ecology_cards, min_science_cards, min_society_cards, is_enabled
        FROM game.game_core_special_condition_config
        WHERE is_enabled = TRUE
        ORDER BY card_id ASC
    </select>

    <select id="selectEnabledRuntimeParamConfig" resultMap="RuntimeParamResultMap">
        SELECT config_id, core_hand_limit, policy_hand_limit, max_combo_per_turn, max_turn,
               trade_window_interval,
               base_carbon_price, max_carbon_quota, domain_progress_card_cap,
               ending_display_seconds, turn_transition_animation_enabled_default, turn_transition_animation_seconds,
               is_enabled
        FROM game.game_runtime_param_config
        WHERE is_enabled = TRUE
        ORDER BY config_id ASC
        LIMIT 1
    </select>

    <select id="selectEnabledBalanceRuleConfig" resultMap="BalanceRuleResultMap">
        SELECT config_id, initial_phase, initial_event_cooldown, board_size,
               initial_industry, initial_tech, initial_population,
               initial_green, initial_carbon, initial_satisfaction, initial_low_carbon_score, initial_quota,
               initial_draw_early, draw_count_early, draw_count_mid, draw_count_late,
               event_cooldown_reset_turns, settlement_base_industry_gain, settlement_base_tech_gain, settlement_base_population_gain, satisfaction_max,
               carbon_quota_base_line, carbon_quota_per_n_over,
               carbon_industry_emission_per_card, carbon_ecology_reduction_per_card, carbon_science_reduction_per_card,
               trade_random_base_min, trade_random_span, trade_high_carbon_threshold, trade_high_carbon_factor,
               trade_low_carbon_threshold, trade_low_carbon_factor,
               failure_high_carbon_threshold, failure_high_carbon_streak_limit,
               trade_failure_quota_exhausted_limit, trade_failure_profit_threshold,
               low_carbon_min_for_positive_ending, low_carbon_domain_threshold, low_carbon_domain_bonus,
               low_carbon_policy_unlock_score, low_carbon_policy_unlock_all_count, low_carbon_policy_unlock_all_bonus,
               low_carbon_event_resolved_score, low_carbon_event_triggered_penalty,
               low_carbon_over_limit_carbon_threshold, low_carbon_over_limit_streak_threshold, low_carbon_over_limit_streak_penalty,
               low_carbon_trade_profit_divisor, low_carbon_trade_profit_bonus,
               low_carbon_quota_exhausted_penalty, low_carbon_invalid_operation_penalty,
               carbon_tier_1_max, carbon_tier_1_score, carbon_tier_2_max, carbon_tier_2_score,
               carbon_tier_3_max, carbon_tier_3_score, carbon_tier_4_max, carbon_tier_4_score, carbon_tier_5_score,
               phase_early_max_cards, phase_early_max_score, phase_mid_min_cards, phase_mid_max_cards,
               phase_mid_min_score, phase_mid_max_score, phase_late_min_cards, phase_late_min_score, phase_late_remaining_cards_threshold,
               ending_event_resolve_rate_required,
               ending_innovation_min_science, ending_innovation_min_tech, ending_innovation_min_low_carbon, ending_innovation_max_carbon, ending_innovation_min_profit,
               ending_ecology_min_ecology, ending_ecology_min_green, ending_ecology_min_low_carbon, ending_ecology_max_carbon, ending_ecology_min_quota,
               ending_doughnut_min_society, ending_doughnut_min_satisfaction, ending_doughnut_min_population, ending_doughnut_min_domain,
               ending_doughnut_min_low_carbon, ending_doughnut_max_carbon, ending_doughnut_min_policy_usage_6768,
               is_enabled
        FROM game.game_balance_rule_config
        WHERE is_enabled = TRUE
        ORDER BY config_id ASC
        LIMIT 1
    </select>

    <select id="selectEnabledEndingContents" resultMap="EndingContentResultMap">
        SELECT ending_id, ending_name, image_key, default_reason,
               failure_reason_high_carbon, failure_reason_trade, failure_reason_low_score, failure_reason_boundary_default, is_enabled
        FROM game.game_ending_content_config
        WHERE is_enabled = TRUE
        ORDER BY ending_id ASC
    </select>

    <insert id="upsertRuntimeParamConfig">
        INSERT INTO game.game_runtime_param_config (
            config_id, core_hand_limit, policy_hand_limit, max_combo_per_turn, max_turn,
            trade_window_interval,
            base_carbon_price, max_carbon_quota, domain_progress_card_cap,
            ending_display_seconds, turn_transition_animation_enabled_default, turn_transition_animation_seconds,
            is_enabled
        ) VALUES (
            #{configId, jdbcType=INTEGER},
            #{coreHandLimit, jdbcType=INTEGER},
            #{policyHandLimit, jdbcType=INTEGER},
            #{maxComboPerTurn, jdbcType=INTEGER},
            #{maxTurn, jdbcType=INTEGER},
            #{tradeWindowInterval, jdbcType=INTEGER},
            #{baseCarbonPrice, jdbcType=DOUBLE},
            #{maxCarbonQuota, jdbcType=INTEGER},
            #{domainProgressCardCap, jdbcType=INTEGER},
            #{endingDisplaySeconds, jdbcType=INTEGER},
            #{turnTransitionAnimationEnabledDefault, jdbcType=BOOLEAN},
            #{turnTransitionAnimationSeconds, jdbcType=INTEGER},
            TRUE
        )
        ON CONFLICT (config_id) DO UPDATE SET
            core_hand_limit = EXCLUDED.core_hand_limit,
            policy_hand_limit = EXCLUDED.policy_hand_limit,
            max_combo_per_turn = EXCLUDED.max_combo_per_turn,
            max_turn = EXCLUDED.max_turn,
            trade_window_interval = EXCLUDED.trade_window_interval,
            base_carbon_price = EXCLUDED.base_carbon_price,
            max_carbon_quota = EXCLUDED.max_carbon_quota,
            domain_progress_card_cap = EXCLUDED.domain_progress_card_cap,
            ending_display_seconds = EXCLUDED.ending_display_seconds,
            turn_transition_animation_enabled_default = EXCLUDED.turn_transition_animation_enabled_default,
            turn_transition_animation_seconds = EXCLUDED.turn_transition_animation_seconds,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <insert id="upsertBalanceRuleConfig">
        INSERT INTO game.game_balance_rule_config (
            config_id, initial_phase, initial_event_cooldown, board_size, initial_industry, initial_tech, initial_population,
            initial_green, initial_carbon, initial_satisfaction, initial_low_carbon_score, initial_quota,
            initial_draw_early, draw_count_early, draw_count_mid, draw_count_late, event_cooldown_reset_turns,
            settlement_base_industry_gain, settlement_base_tech_gain, settlement_base_population_gain, satisfaction_max,
            carbon_quota_base_line, carbon_quota_per_n_over, carbon_industry_emission_per_card, carbon_ecology_reduction_per_card,
            carbon_science_reduction_per_card, trade_random_base_min, trade_random_span, trade_high_carbon_threshold, trade_high_carbon_factor,
            trade_low_carbon_threshold, trade_low_carbon_factor, failure_high_carbon_threshold, failure_high_carbon_streak_limit,
            trade_failure_quota_exhausted_limit, trade_failure_profit_threshold, low_carbon_min_for_positive_ending, low_carbon_domain_threshold,
            low_carbon_domain_bonus, low_carbon_policy_unlock_score, low_carbon_policy_unlock_all_count, low_carbon_policy_unlock_all_bonus,
            low_carbon_event_resolved_score, low_carbon_event_triggered_penalty, low_carbon_over_limit_carbon_threshold,
            low_carbon_over_limit_streak_threshold, low_carbon_over_limit_streak_penalty, low_carbon_trade_profit_divisor,
            low_carbon_trade_profit_bonus, low_carbon_quota_exhausted_penalty, low_carbon_invalid_operation_penalty,
            carbon_tier_1_max, carbon_tier_1_score, carbon_tier_2_max, carbon_tier_2_score, carbon_tier_3_max, carbon_tier_3_score,
            carbon_tier_4_max, carbon_tier_4_score, carbon_tier_5_score, phase_early_max_cards, phase_early_max_score, phase_mid_min_cards,
            phase_mid_max_cards, phase_mid_min_score, phase_mid_max_score, phase_late_min_cards, phase_late_min_score,
            phase_late_remaining_cards_threshold, ending_event_resolve_rate_required, ending_innovation_min_science, ending_innovation_min_tech,
            ending_innovation_min_low_carbon, ending_innovation_max_carbon, ending_innovation_min_profit, ending_ecology_min_ecology,
            ending_ecology_min_green, ending_ecology_min_low_carbon, ending_ecology_max_carbon, ending_ecology_min_quota,
            ending_doughnut_min_society, ending_doughnut_min_satisfaction, ending_doughnut_min_population, ending_doughnut_min_domain,
            ending_doughnut_min_low_carbon, ending_doughnut_max_carbon, ending_doughnut_min_policy_usage_6768, is_enabled
        ) VALUES (
            #{configId, jdbcType=INTEGER}, #{initialPhase, jdbcType=VARCHAR}, #{initialEventCooldown, jdbcType=INTEGER}, #{boardSize, jdbcType=INTEGER},
            #{initialIndustry, jdbcType=INTEGER}, #{initialTech, jdbcType=INTEGER}, #{initialPopulation, jdbcType=INTEGER},
            #{initialGreen, jdbcType=INTEGER}, #{initialCarbon, jdbcType=INTEGER}, #{initialSatisfaction, jdbcType=INTEGER},
            #{initialLowCarbonScore, jdbcType=INTEGER}, #{initialQuota, jdbcType=INTEGER}, #{initialDrawEarly, jdbcType=INTEGER},
            #{drawCountEarly, jdbcType=INTEGER}, #{drawCountMid, jdbcType=INTEGER}, #{drawCountLate, jdbcType=INTEGER},
            #{eventCooldownResetTurns, jdbcType=INTEGER}, #{settlementBaseIndustryGain, jdbcType=INTEGER},
            #{settlementBaseTechGain, jdbcType=INTEGER}, #{settlementBasePopulationGain, jdbcType=INTEGER}, #{satisfactionMax, jdbcType=INTEGER},
            #{carbonQuotaBaseLine, jdbcType=INTEGER}, #{carbonQuotaPerNOver, jdbcType=INTEGER}, #{carbonIndustryEmissionPerCard, jdbcType=INTEGER},
            #{carbonEcologyReductionPerCard, jdbcType=INTEGER}, #{carbonScienceReductionPerCard, jdbcType=INTEGER},
            #{tradeRandomBaseMin, jdbcType=DOUBLE}, #{tradeRandomSpan, jdbcType=DOUBLE}, #{tradeHighCarbonThreshold, jdbcType=INTEGER},
            #{tradeHighCarbonFactor, jdbcType=DOUBLE}, #{tradeLowCarbonThreshold, jdbcType=INTEGER}, #{tradeLowCarbonFactor, jdbcType=DOUBLE},
            #{failureHighCarbonThreshold, jdbcType=INTEGER}, #{failureHighCarbonStreakLimit, jdbcType=INTEGER},
            #{tradeFailureQuotaExhaustedLimit, jdbcType=INTEGER}, #{tradeFailureProfitThreshold, jdbcType=DOUBLE},
            #{lowCarbonMinForPositiveEnding, jdbcType=INTEGER}, #{lowCarbonDomainThreshold, jdbcType=INTEGER}, #{lowCarbonDomainBonus, jdbcType=INTEGER},
            #{lowCarbonPolicyUnlockScore, jdbcType=INTEGER}, #{lowCarbonPolicyUnlockAllCount, jdbcType=INTEGER}, #{lowCarbonPolicyUnlockAllBonus, jdbcType=INTEGER},
            #{lowCarbonEventResolvedScore, jdbcType=INTEGER}, #{lowCarbonEventTriggeredPenalty, jdbcType=INTEGER},
            #{lowCarbonOverLimitCarbonThreshold, jdbcType=INTEGER}, #{lowCarbonOverLimitStreakThreshold, jdbcType=INTEGER},
            #{lowCarbonOverLimitStreakPenalty, jdbcType=INTEGER}, #{lowCarbonTradeProfitDivisor, jdbcType=DOUBLE},
            #{lowCarbonTradeProfitBonus, jdbcType=INTEGER}, #{lowCarbonQuotaExhaustedPenalty, jdbcType=INTEGER},
            #{lowCarbonInvalidOperationPenalty, jdbcType=INTEGER}, #{carbonTier1Max, jdbcType=INTEGER}, #{carbonTier1Score, jdbcType=INTEGER},
            #{carbonTier2Max, jdbcType=INTEGER}, #{carbonTier2Score, jdbcType=INTEGER}, #{carbonTier3Max, jdbcType=INTEGER}, #{carbonTier3Score, jdbcType=INTEGER},
            #{carbonTier4Max, jdbcType=INTEGER}, #{carbonTier4Score, jdbcType=INTEGER}, #{carbonTier5Score, jdbcType=INTEGER},
            #{phaseEarlyMaxCards, jdbcType=INTEGER}, #{phaseEarlyMaxScore, jdbcType=INTEGER}, #{phaseMidMinCards, jdbcType=INTEGER},
            #{phaseMidMaxCards, jdbcType=INTEGER}, #{phaseMidMinScore, jdbcType=INTEGER}, #{phaseMidMaxScore, jdbcType=INTEGER},
            #{phaseLateMinCards, jdbcType=INTEGER}, #{phaseLateMinScore, jdbcType=INTEGER}, #{phaseLateRemainingCardsThreshold, jdbcType=INTEGER},
            #{endingEventResolveRateRequired, jdbcType=DOUBLE}, #{endingInnovationMinScience, jdbcType=INTEGER},
            #{endingInnovationMinTech, jdbcType=INTEGER}, #{endingInnovationMinLowCarbon, jdbcType=INTEGER},
            #{endingInnovationMaxCarbon, jdbcType=INTEGER}, #{endingInnovationMinProfit, jdbcType=DOUBLE}, #{endingEcologyMinEcology, jdbcType=INTEGER},
            #{endingEcologyMinGreen, jdbcType=INTEGER}, #{endingEcologyMinLowCarbon, jdbcType=INTEGER}, #{endingEcologyMaxCarbon, jdbcType=INTEGER},
            #{endingEcologyMinQuota, jdbcType=INTEGER}, #{endingDoughnutMinSociety, jdbcType=INTEGER},
            #{endingDoughnutMinSatisfaction, jdbcType=INTEGER}, #{endingDoughnutMinPopulation, jdbcType=INTEGER},
            #{endingDoughnutMinDomain, jdbcType=INTEGER}, #{endingDoughnutMinLowCarbon, jdbcType=INTEGER},
            #{endingDoughnutMaxCarbon, jdbcType=INTEGER}, #{endingDoughnutMinPolicyUsage6768, jdbcType=INTEGER}, TRUE
        )
        ON CONFLICT (config_id) DO UPDATE SET
            initial_phase = EXCLUDED.initial_phase,
            initial_event_cooldown = EXCLUDED.initial_event_cooldown,
            board_size = EXCLUDED.board_size,
            initial_industry = EXCLUDED.initial_industry,
            initial_tech = EXCLUDED.initial_tech,
            initial_population = EXCLUDED.initial_population,
            initial_green = EXCLUDED.initial_green,
            initial_carbon = EXCLUDED.initial_carbon,
            initial_satisfaction = EXCLUDED.initial_satisfaction,
            initial_low_carbon_score = EXCLUDED.initial_low_carbon_score,
            initial_quota = EXCLUDED.initial_quota,
            initial_draw_early = EXCLUDED.initial_draw_early,
            draw_count_early = EXCLUDED.draw_count_early,
            draw_count_mid = EXCLUDED.draw_count_mid,
            draw_count_late = EXCLUDED.draw_count_late,
            event_cooldown_reset_turns = EXCLUDED.event_cooldown_reset_turns,
            settlement_base_industry_gain = EXCLUDED.settlement_base_industry_gain,
            settlement_base_tech_gain = EXCLUDED.settlement_base_tech_gain,
            settlement_base_population_gain = EXCLUDED.settlement_base_population_gain,
            satisfaction_max = EXCLUDED.satisfaction_max,
            carbon_quota_base_line = EXCLUDED.carbon_quota_base_line,
            carbon_quota_per_n_over = EXCLUDED.carbon_quota_per_n_over,
            carbon_industry_emission_per_card = EXCLUDED.carbon_industry_emission_per_card,
            carbon_ecology_reduction_per_card = EXCLUDED.carbon_ecology_reduction_per_card,
            carbon_science_reduction_per_card = EXCLUDED.carbon_science_reduction_per_card,
            trade_random_base_min = EXCLUDED.trade_random_base_min,
            trade_random_span = EXCLUDED.trade_random_span,
            trade_high_carbon_threshold = EXCLUDED.trade_high_carbon_threshold,
            trade_high_carbon_factor = EXCLUDED.trade_high_carbon_factor,
            trade_low_carbon_threshold = EXCLUDED.trade_low_carbon_threshold,
            trade_low_carbon_factor = EXCLUDED.trade_low_carbon_factor,
            failure_high_carbon_threshold = EXCLUDED.failure_high_carbon_threshold,
            failure_high_carbon_streak_limit = EXCLUDED.failure_high_carbon_streak_limit,
            trade_failure_quota_exhausted_limit = EXCLUDED.trade_failure_quota_exhausted_limit,
            trade_failure_profit_threshold = EXCLUDED.trade_failure_profit_threshold,
            low_carbon_min_for_positive_ending = EXCLUDED.low_carbon_min_for_positive_ending,
            low_carbon_domain_threshold = EXCLUDED.low_carbon_domain_threshold,
            low_carbon_domain_bonus = EXCLUDED.low_carbon_domain_bonus,
            low_carbon_policy_unlock_score = EXCLUDED.low_carbon_policy_unlock_score,
            low_carbon_policy_unlock_all_count = EXCLUDED.low_carbon_policy_unlock_all_count,
            low_carbon_policy_unlock_all_bonus = EXCLUDED.low_carbon_policy_unlock_all_bonus,
            low_carbon_event_resolved_score = EXCLUDED.low_carbon_event_resolved_score,
            low_carbon_event_triggered_penalty = EXCLUDED.low_carbon_event_triggered_penalty,
            low_carbon_over_limit_carbon_threshold = EXCLUDED.low_carbon_over_limit_carbon_threshold,
            low_carbon_over_limit_streak_threshold = EXCLUDED.low_carbon_over_limit_streak_threshold,
            low_carbon_over_limit_streak_penalty = EXCLUDED.low_carbon_over_limit_streak_penalty,
            low_carbon_trade_profit_divisor = EXCLUDED.low_carbon_trade_profit_divisor,
            low_carbon_trade_profit_bonus = EXCLUDED.low_carbon_trade_profit_bonus,
            low_carbon_quota_exhausted_penalty = EXCLUDED.low_carbon_quota_exhausted_penalty,
            low_carbon_invalid_operation_penalty = EXCLUDED.low_carbon_invalid_operation_penalty,
            carbon_tier_1_max = EXCLUDED.carbon_tier_1_max,
            carbon_tier_1_score = EXCLUDED.carbon_tier_1_score,
            carbon_tier_2_max = EXCLUDED.carbon_tier_2_max,
            carbon_tier_2_score = EXCLUDED.carbon_tier_2_score,
            carbon_tier_3_max = EXCLUDED.carbon_tier_3_max,
            carbon_tier_3_score = EXCLUDED.carbon_tier_3_score,
            carbon_tier_4_max = EXCLUDED.carbon_tier_4_max,
            carbon_tier_4_score = EXCLUDED.carbon_tier_4_score,
            carbon_tier_5_score = EXCLUDED.carbon_tier_5_score,
            phase_early_max_cards = EXCLUDED.phase_early_max_cards,
            phase_early_max_score = EXCLUDED.phase_early_max_score,
            phase_mid_min_cards = EXCLUDED.phase_mid_min_cards,
            phase_mid_max_cards = EXCLUDED.phase_mid_max_cards,
            phase_mid_min_score = EXCLUDED.phase_mid_min_score,
            phase_mid_max_score = EXCLUDED.phase_mid_max_score,
            phase_late_min_cards = EXCLUDED.phase_late_min_cards,
            phase_late_min_score = EXCLUDED.phase_late_min_score,
            phase_late_remaining_cards_threshold = EXCLUDED.phase_late_remaining_cards_threshold,
            ending_event_resolve_rate_required = EXCLUDED.ending_event_resolve_rate_required,
            ending_innovation_min_science = EXCLUDED.ending_innovation_min_science,
            ending_innovation_min_tech = EXCLUDED.ending_innovation_min_tech,
            ending_innovation_min_low_carbon = EXCLUDED.ending_innovation_min_low_carbon,
            ending_innovation_max_carbon = EXCLUDED.ending_innovation_max_carbon,
            ending_innovation_min_profit = EXCLUDED.ending_innovation_min_profit,
            ending_ecology_min_ecology = EXCLUDED.ending_ecology_min_ecology,
            ending_ecology_min_green = EXCLUDED.ending_ecology_min_green,
            ending_ecology_min_low_carbon = EXCLUDED.ending_ecology_min_low_carbon,
            ending_ecology_max_carbon = EXCLUDED.ending_ecology_max_carbon,
            ending_ecology_min_quota = EXCLUDED.ending_ecology_min_quota,
            ending_doughnut_min_society = EXCLUDED.ending_doughnut_min_society,
            ending_doughnut_min_satisfaction = EXCLUDED.ending_doughnut_min_satisfaction,
            ending_doughnut_min_population = EXCLUDED.ending_doughnut_min_population,
            ending_doughnut_min_domain = EXCLUDED.ending_doughnut_min_domain,
            ending_doughnut_min_low_carbon = EXCLUDED.ending_doughnut_min_low_carbon,
            ending_doughnut_max_carbon = EXCLUDED.ending_doughnut_max_carbon,
            ending_doughnut_min_policy_usage_6768 = EXCLUDED.ending_doughnut_min_policy_usage_6768,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllEventRules">
        UPDATE game.game_event_rule_config
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertEventRule">
        INSERT INTO game.game_event_rule_config (
            event_type, trigger_probability_pct, min_green, min_carbon, max_satisfaction, min_population, require_even_turn,
            weight, duration_turns, green_delta, carbon_delta, satisfaction_delta, green_pct_delta, population_pct_delta,
            quota_delta, display_name, effect_summary, resolution_hint, resolvable_policy_ids_csv, is_enabled
        ) VALUES (
            #{eventType, jdbcType=VARCHAR}, #{triggerProbabilityPct, jdbcType=INTEGER}, #{minGreen, jdbcType=INTEGER},
            #{minCarbon, jdbcType=INTEGER}, #{maxSatisfaction, jdbcType=INTEGER}, #{minPopulation, jdbcType=INTEGER},
            #{requireEvenTurn, jdbcType=BOOLEAN}, #{weight, jdbcType=INTEGER}, #{durationTurns, jdbcType=INTEGER},
            #{greenDelta, jdbcType=INTEGER}, #{carbonDelta, jdbcType=INTEGER}, #{satisfactionDelta, jdbcType=INTEGER},
            #{greenPctDelta, jdbcType=INTEGER}, #{populationPctDelta, jdbcType=INTEGER}, #{quotaDelta, jdbcType=INTEGER},
            #{displayName, jdbcType=VARCHAR}, #{effectSummary, jdbcType=VARCHAR}, #{resolutionHint, jdbcType=VARCHAR},
            #{resolvablePolicyIdsCsv, jdbcType=VARCHAR}, TRUE
        )
        ON CONFLICT (event_type) DO UPDATE SET
            trigger_probability_pct = EXCLUDED.trigger_probability_pct,
            min_green = EXCLUDED.min_green,
            min_carbon = EXCLUDED.min_carbon,
            max_satisfaction = EXCLUDED.max_satisfaction,
            min_population = EXCLUDED.min_population,
            require_even_turn = EXCLUDED.require_even_turn,
            weight = EXCLUDED.weight,
            duration_turns = EXCLUDED.duration_turns,
            green_delta = EXCLUDED.green_delta,
            carbon_delta = EXCLUDED.carbon_delta,
            satisfaction_delta = EXCLUDED.satisfaction_delta,
            green_pct_delta = EXCLUDED.green_pct_delta,
            population_pct_delta = EXCLUDED.population_pct_delta,
            quota_delta = EXCLUDED.quota_delta,
            display_name = EXCLUDED.display_name,
            effect_summary = EXCLUDED.effect_summary,
            resolution_hint = EXCLUDED.resolution_hint,
            resolvable_policy_ids_csv = EXCLUDED.resolvable_policy_ids_csv,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllComboRules">
        UPDATE game.game_combo_rule_config
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertComboRule">
        INSERT INTO game.game_combo_rule_config (
            combo_id, priority_order, required_policy_id, min_industry, min_ecology, min_science, min_society,
            min_low_carbon_industry, min_shenzhen_ecology, min_link_cards, min_industry_low_carbon_adjacent_pairs,
            min_science_science_adjacent_pairs, min_science_industry_adjacent_pairs, min_industry_ecology_adjacent_pairs,
            min_society_ecology_adjacent_pairs, effect_industry_delta, effect_tech_delta, effect_population_delta,
            effect_green_delta, effect_carbon_delta, effect_satisfaction_delta, effect_quota_delta, effect_low_carbon_delta,
            effect_tech_pct, effect_population_pct, effect_industry_pct, effect_low_carbon_pct, effect_green_pct, effect_global_pct, is_enabled
        ) VALUES (
            #{comboId, jdbcType=VARCHAR}, #{priorityOrder, jdbcType=INTEGER}, #{requiredPolicyId, jdbcType=VARCHAR},
            #{minIndustry, jdbcType=INTEGER}, #{minEcology, jdbcType=INTEGER}, #{minScience, jdbcType=INTEGER}, #{minSociety, jdbcType=INTEGER},
            #{minLowCarbonIndustry, jdbcType=INTEGER}, #{minShenzhenEcology, jdbcType=INTEGER}, #{minLinkCards, jdbcType=INTEGER},
            #{minIndustryLowCarbonAdjacentPairs, jdbcType=INTEGER}, #{minScienceScienceAdjacentPairs, jdbcType=INTEGER},
            #{minScienceIndustryAdjacentPairs, jdbcType=INTEGER}, #{minIndustryEcologyAdjacentPairs, jdbcType=INTEGER},
            #{minSocietyEcologyAdjacentPairs, jdbcType=INTEGER}, #{effectIndustryDelta, jdbcType=INTEGER}, #{effectTechDelta, jdbcType=INTEGER},
            #{effectPopulationDelta, jdbcType=INTEGER}, #{effectGreenDelta, jdbcType=INTEGER}, #{effectCarbonDelta, jdbcType=INTEGER},
            #{effectSatisfactionDelta, jdbcType=INTEGER}, #{effectQuotaDelta, jdbcType=INTEGER}, #{effectLowCarbonDelta, jdbcType=INTEGER},
            #{effectTechPct, jdbcType=INTEGER}, #{effectPopulationPct, jdbcType=INTEGER}, #{effectIndustryPct, jdbcType=INTEGER},
            #{effectLowCarbonPct, jdbcType=INTEGER}, #{effectGreenPct, jdbcType=INTEGER}, #{effectGlobalPct, jdbcType=INTEGER}, TRUE
        )
        ON CONFLICT (combo_id) DO UPDATE SET
            priority_order = EXCLUDED.priority_order,
            required_policy_id = EXCLUDED.required_policy_id,
            min_industry = EXCLUDED.min_industry,
            min_ecology = EXCLUDED.min_ecology,
            min_science = EXCLUDED.min_science,
            min_society = EXCLUDED.min_society,
            min_low_carbon_industry = EXCLUDED.min_low_carbon_industry,
            min_shenzhen_ecology = EXCLUDED.min_shenzhen_ecology,
            min_link_cards = EXCLUDED.min_link_cards,
            min_industry_low_carbon_adjacent_pairs = EXCLUDED.min_industry_low_carbon_adjacent_pairs,
            min_science_science_adjacent_pairs = EXCLUDED.min_science_science_adjacent_pairs,
            min_science_industry_adjacent_pairs = EXCLUDED.min_science_industry_adjacent_pairs,
            min_industry_ecology_adjacent_pairs = EXCLUDED.min_industry_ecology_adjacent_pairs,
            min_society_ecology_adjacent_pairs = EXCLUDED.min_society_ecology_adjacent_pairs,
            effect_industry_delta = EXCLUDED.effect_industry_delta,
            effect_tech_delta = EXCLUDED.effect_tech_delta,
            effect_population_delta = EXCLUDED.effect_population_delta,
            effect_green_delta = EXCLUDED.effect_green_delta,
            effect_carbon_delta = EXCLUDED.effect_carbon_delta,
            effect_satisfaction_delta = EXCLUDED.effect_satisfaction_delta,
            effect_quota_delta = EXCLUDED.effect_quota_delta,
            effect_low_carbon_delta = EXCLUDED.effect_low_carbon_delta,
            effect_tech_pct = EXCLUDED.effect_tech_pct,
            effect_population_pct = EXCLUDED.effect_population_pct,
            effect_industry_pct = EXCLUDED.effect_industry_pct,
            effect_low_carbon_pct = EXCLUDED.effect_low_carbon_pct,
            effect_green_pct = EXCLUDED.effect_green_pct,
            effect_global_pct = EXCLUDED.effect_global_pct,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllPolicyUnlockRules">
        UPDATE game.game_policy_unlock_rule_config
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertPolicyUnlockRule">
        INSERT INTO game.game_policy_unlock_rule_config (
            policy_id, priority_order, min_industry, min_ecology, min_science, min_society,
            min_industry_resource, min_tech_resource, min_population_resource, min_green, min_carbon,
            max_carbon, min_satisfaction, min_tagged_cards, required_tag, is_enabled
        ) VALUES (
            #{policyId, jdbcType=VARCHAR}, #{priorityOrder, jdbcType=INTEGER}, #{minIndustry, jdbcType=INTEGER},
            #{minEcology, jdbcType=INTEGER}, #{minScience, jdbcType=INTEGER}, #{minSociety, jdbcType=INTEGER},
            #{minIndustryResource, jdbcType=INTEGER}, #{minTechResource, jdbcType=INTEGER}, #{minPopulationResource, jdbcType=INTEGER},
            #{minGreen, jdbcType=INTEGER}, #{minCarbon, jdbcType=INTEGER}, #{maxCarbon, jdbcType=INTEGER},
            #{minSatisfaction, jdbcType=INTEGER}, #{minTaggedCards, jdbcType=INTEGER}, #{requiredTag, jdbcType=VARCHAR}, TRUE
        )
        ON CONFLICT (policy_id) DO UPDATE SET
            priority_order = EXCLUDED.priority_order,
            min_industry = EXCLUDED.min_industry,
            min_ecology = EXCLUDED.min_ecology,
            min_science = EXCLUDED.min_science,
            min_society = EXCLUDED.min_society,
            min_industry_resource = EXCLUDED.min_industry_resource,
            min_tech_resource = EXCLUDED.min_tech_resource,
            min_population_resource = EXCLUDED.min_population_resource,
            min_green = EXCLUDED.min_green,
            min_carbon = EXCLUDED.min_carbon,
            max_carbon = EXCLUDED.max_carbon,
            min_satisfaction = EXCLUDED.min_satisfaction,
            min_tagged_cards = EXCLUDED.min_tagged_cards,
            required_tag = EXCLUDED.required_tag,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllCoreSpecialConditions">
        UPDATE game.game_core_special_condition_config
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertCoreSpecialCondition">
        INSERT INTO game.game_core_special_condition_config (
            card_id, required_event_type, min_industry_cards, min_ecology_cards, min_science_cards, min_society_cards, is_enabled
        ) VALUES (
            #{cardId, jdbcType=VARCHAR}, #{requiredEventType, jdbcType=VARCHAR}, #{minIndustryCards, jdbcType=INTEGER},
            #{minEcologyCards, jdbcType=INTEGER}, #{minScienceCards, jdbcType=INTEGER}, #{minSocietyCards, jdbcType=INTEGER}, TRUE
        )
        ON CONFLICT (card_id) DO UPDATE SET
            required_event_type = EXCLUDED.required_event_type,
            min_industry_cards = EXCLUDED.min_industry_cards,
            min_ecology_cards = EXCLUDED.min_ecology_cards,
            min_science_cards = EXCLUDED.min_science_cards,
            min_society_cards = EXCLUDED.min_society_cards,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllCardTags">
        UPDATE game.game_card_tag_map
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertCardTag">
        INSERT INTO game.game_card_tag_map (
            card_id, tag_code, is_enabled
        ) VALUES (
            #{cardId, jdbcType=VARCHAR}, #{tagCode, jdbcType=VARCHAR}, TRUE
        )
        ON CONFLICT (card_id, tag_code) DO UPDATE SET
            is_enabled = TRUE,
            updated_at = now()
    </insert>

    <update id="disableAllEndingContents">
        UPDATE game.game_ending_content_config
        SET is_enabled = FALSE,
            updated_at = now()
    </update>

    <insert id="upsertEndingContent">
        INSERT INTO game.game_ending_content_config (
            ending_id, ending_name, image_key, default_reason, failure_reason_high_carbon,
            failure_reason_trade, failure_reason_low_score, failure_reason_boundary_default, is_enabled
        ) VALUES (
            #{endingId, jdbcType=VARCHAR}, #{endingName, jdbcType=VARCHAR}, #{imageKey, jdbcType=VARCHAR},
            #{defaultReason, jdbcType=VARCHAR}, #{failureReasonHighCarbon, jdbcType=VARCHAR},
            #{failureReasonTrade, jdbcType=VARCHAR}, #{failureReasonLowScore, jdbcType=VARCHAR},
            #{failureReasonBoundaryDefault, jdbcType=VARCHAR}, TRUE
        )
        ON CONFLICT (ending_id) DO UPDATE SET
            ending_name = EXCLUDED.ending_name,
            image_key = EXCLUDED.image_key,
            default_reason = EXCLUDED.default_reason,
            failure_reason_high_carbon = EXCLUDED.failure_reason_high_carbon,
            failure_reason_trade = EXCLUDED.failure_reason_trade,
            failure_reason_low_score = EXCLUDED.failure_reason_low_score,
            failure_reason_boundary_default = EXCLUDED.failure_reason_boundary_default,
            is_enabled = TRUE,
            updated_at = now()
    </insert>

</mapper>

<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.youthloop.common.persistence.mapper.UserFeedbackMapper">

  <resultMap id="BaseResultMap" type="com.youthloop.common.domain.model.UserFeedback">
    <id column="id" property="id" jdbcType="OTHER" typeHandler="com.youthloop.common.persistence.UuidTypeHandler"/>
    <result column="user_id" property="userId" jdbcType="OTHER" typeHandler="com.youthloop.common.persistence.UuidTypeHandler"/>
    <result column="type" property="type" jdbcType="INTEGER"/>
    <result column="rating" property="rating" jdbcType="INTEGER"/>
    <result column="title" property="title" jdbcType="VARCHAR"/>
    <result column="content" property="content" jdbcType="VARCHAR"/>
    <result column="contact" property="contact" jdbcType="VARCHAR"/>
    <result column="anonymous" property="anonymous" jdbcType="BOOLEAN"/>
    <result column="status" property="status" jdbcType="INTEGER"/>
    <result column="created_at" property="createdAt" jdbcType="TIMESTAMP"/>
    <result column="meta" property="meta" jdbcType="VARCHAR"/>
  </resultMap>

  <insert id="insert">
    INSERT INTO social.user_feedback (id, user_id, type, rating, title, content, contact, anonymous, status, created_at, meta)
    VALUES (
      #{id}::uuid,
      #{userId}::uuid,
      #{type},
      #{rating},
      #{title},
      #{content},
      #{contact},
      #{anonymous},
      #{status},
      #{createdAt},
      #{meta}::jsonb
    )
  </insert>

  <select id="selectById" resultMap="BaseResultMap">
    SELECT id, user_id, type, rating, title, content, contact, anonymous, status, created_at, meta
    FROM social.user_feedback
    WHERE id = #{id}::uuid
  </select>

</mapper>

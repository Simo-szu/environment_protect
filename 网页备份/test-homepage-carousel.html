<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>主页轮播测试</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* 轮播样式核心 */
        .carousel-container {
            perspective: 1000px;
            overflow: hidden; 
        }
        .carousel-item {
            position: absolute;
            top: 50%;
            width: 200px; 
            height: 260px;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center center;
            opacity: 0;
            z-index: 10;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
        }
        .carousel-item.pos-0 { 
            left: 25%; 
            opacity: 1; 
            z-index: 20;
            transform: translateY(-50%) translateX(-50%) scale(0.9); 
            filter: blur(0px);
        }
        .carousel-item.pos-1 { 
            left: 50%;
            opacity: 1;
            z-index: 30;
            transform: translateY(-50%) translateX(-50%) scale(1.15); 
            box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.2);
        }
        .carousel-item.pos-2 { 
            left: 75%; 
            opacity: 1; 
            z-index: 20;
            transform: translateY(-50%) translateX(-50%) scale(0.9); 
            filter: blur(0px);
        }
        .carousel-item.pos-3, .carousel-item.pos-hidden { 
            left: 50%;
            opacity: 0;
            z-index: 5;
            transform: translateY(-50%) translateX(-50%) scale(0.5);
            pointer-events: none;
        }
        .carousel-item.pos-1 .card-content-active { 
            display: flex; 
            opacity: 1; 
        }
        .carousel-item.pos-1 .card-content-inactive { 
            display: none; 
            opacity: 0; 
        }
        .carousel-item:not(.pos-1) .card-content-active { 
            display: none; 
            opacity: 0; 
        }
        .carousel-item:not(.pos-1) .card-content-inactive { 
            display: flex; 
            opacity: 1; 
        }
        .carousel-item:not(.pos-1) {
            background-color: white;
            border-width: 1px;
        }
        .carousel-item.pos-1 {
            border: none;
        }
        .decor-circle {
            position: absolute;
            border-radius: 999px;
            opacity: 0.1;
            transition: all 0.5s ease;
        }
        .glass-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-2xl font-bold mb-8 text-center">主页轮播功能测试</h1>
        
        <!-- 轮播区域 -->
        <section class="relative w-full max-w-4xl mx-auto h-[360px] flex items-center justify-center my-4 bg-white rounded-2xl shadow-lg">
            <!-- Prev Button -->
            <button onclick="moveCarousel(-1)" class="absolute left-2 md:-left-4 top-1/2 -translate-y-1/2 z-40 p-3 rounded-full bg-white hover:bg-slate-50 text-slate-300 hover:text-blue-600 transition-all duration-300 border border-slate-100 shadow-sm hover:shadow-md hover:scale-105 group">
                <i data-lucide="chevron-left" class="w-5 h-5 stroke-[2.5px] group-hover:-translate-x-0.5 transition-transform"></i>
            </button>

            <!-- Carousel Track -->
            <div id="carousel-track" class="carousel-container w-full h-full relative">
                <!-- Cards will be injected here by JS -->
            </div>

            <!-- Next Button -->
            <button onclick="moveCarousel(1)" class="absolute right-2 md:-right-4 top-1/2 -translate-y-1/2 z-40 p-3 rounded-full bg-white hover:bg-slate-50 text-slate-300 hover:text-blue-600 transition-all duration-300 border border-slate-100 shadow-sm hover:shadow-md hover:scale-105 group">
                <i data-lucide="chevron-right" class="w-5 h-5 stroke-[2.5px] group-hover:translate-x-0.5 transition-transform"></i>
            </button>
        </section>

        <div class="text-center mt-8">
            <p class="text-gray-600">点击左右箭头测试轮播功能</p>
            <p class="text-sm text-gray-500 mt-2">当前中心卡片: <span id="current-card">绿色游戏</span></p>
        </div>
    </div>

    <script>
        // 初始化图标
        lucide.createIcons();

        // 定义四张卡片的数据
        const cardsData = [
            {
                id: 'points',
                title: '积分·兑换',
                sub: '累积环保值',
                color: '#F0A32F',
                icon: 'gift',
                decorPosition: 'top: 0; right: 0; border-bottom-left-radius: 100%;', 
                link: '积分页面.html'
            },
            {
                id: 'game',
                title: '绿色游戏',
                sub: '虚拟种植',
                color: '#56B949',
                icon: 'gamepad-2',
                decorPosition: 'top: 0; left: 0; border-bottom-right-radius: 100%;',
                link: '游戏页面.html'
            },
            {
                id: 'science',
                title: '权威科普',
                sub: '科学数据',
                color: '#30499B',
                icon: 'book-open-check',
                decorPosition: 'bottom: 0; left: 0; border-top-right-radius: 100%;',
                link: '科普页面.html'
            },
            {
                id: 'activity',
                title: '环保活动',
                sub: '参与行动',
                color: '#EE4035',
                icon: 'calendar-heart',
                decorPosition: 'bottom: 0; right: 0; border-top-left-radius: 100%;',
                link: '活动页面.html'
            }
        ];

        let activeIndex = 1; // 默认选中第二个
        const track = document.getElementById('carousel-track');
        const currentCardDisplay = document.getElementById('current-card');

        function createCard(data, index) {
            const div = document.createElement('div');
            div.className = 'carousel-item rounded-[1.5rem] shadow-sm transition-all duration-500';
            div.dataset.index = index;
            div.onclick = () => {
                if (index !== activeIndex) {
                    const diff = index - activeIndex;
                    if(diff === 1 || diff === -3) moveCarousel(1);
                    else if(diff === -1 || diff === 3) moveCarousel(-1);
                    else moveCarousel(2);
                } else {
                    console.log(`点击中心卡片: ${data.title}`);
                    alert(`点击了中心卡片: ${data.title}`);
                }
            };

            // 激活态的内容
            const activeContent = `<div class="card-content-active flex flex-col items-center justify-center text-center w-full h-full relative overflow-hidden p-4 z-20">
                <i data-lucide="${data.icon}" class="w-10 h-10 text-white mb-3 stroke-[1.5]"></i>
                <h3 class="text-2xl text-white font-serif font-medium leading-tight mb-4 whitespace-nowrap">${data.title}</h3>
                <button class="glass-btn px-4 py-1.5 rounded-full text-white text-xs font-medium hover:bg-white/30 transition-colors">进入</button>
                <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none"></div>
            </div>`;

            // 非激活态的内容
            const inactiveContent = `<div class="card-content-inactive flex flex-col items-center justify-center text-center w-full h-full relative overflow-hidden p-4 z-10">
                <div class="decor-circle w-16 h-16" style="background-color: ${data.color}; ${data.decorPosition}"></div>
                <div class="w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-transform group-hover:scale-110" style="background-color: ${data.color}15;">
                    <i data-lucide="${data.icon}" class="w-5 h-5" style="color: ${data.color}"></i>
                </div>
                <h3 class="text-lg font-serif font-bold mb-1 whitespace-nowrap" style="color: #30499B">${data.title.replace('\n', '')}</h3>
                <p class="text-[10px] text-slate-400 font-medium">${data.sub}</p>
            </div>`;

            div.innerHTML = activeContent + inactiveContent;
            return div;
        }

        function initCarousel() {
            track.innerHTML = '';
            cardsData.forEach((data, index) => {
                track.appendChild(createCard(data, index));
            });
            updatePositions();
            lucide.createIcons();
        }

        function updatePositions() {
            const items = Array.from(track.children);
            const total = items.length;
            
            items.forEach((item, i) => {
                item.classList.remove('pos-0', 'pos-1', 'pos-2', 'pos-3', 'pos-hidden');
                item.style.backgroundColor = ''; 
                item.style.borderColor = '';
                item.style.boxShadow = '';
                
                const offset = (i - activeIndex + total) % total;
                
                if (offset === 0) {
                    // ACTIVE (Center)
                    item.classList.add('pos-1');
                    item.style.backgroundColor = cardsData[i].color; 
                    item.style.boxShadow = `0 15px 30px -8px ${cardsData[i].color}40`; 
                } else if (offset === 1) {
                    // RIGHT
                    item.classList.add('pos-2');
                    applyInactiveStyle(item, cardsData[i].color);
                } else if (offset === total - 1) {
                    // LEFT
                    item.classList.add('pos-0');
                    applyInactiveStyle(item, cardsData[i].color);
                } else {
                    // HIDDEN
                    item.classList.add('pos-3');
                }
            });

            // 更新当前卡片显示
            if (currentCardDisplay) {
                currentCardDisplay.textContent = cardsData[activeIndex].title;
            }
        }

        function applyInactiveStyle(element, color) {
            element.style.backgroundColor = '#ffffff';
            element.style.borderColor = `${color}20`; 
            element.style.boxShadow = `0 4px 6px -1px rgba(0, 0, 0, 0.03)`;
        }

        function moveCarousel(direction) {
            const total = cardsData.length;
            activeIndex = (activeIndex + direction + total) % total;
            updatePositions();
        }

        // 初始化轮播
        initCarousel();
    </script>
</body>
</html>
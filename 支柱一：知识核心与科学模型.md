# 支柱一：知识核心与科学模型

**版本：1.0**
**关联蓝图版本：1.0**

## 1.0 文档目标与原则
本文件旨在精确定义“My Digital Biome”模拟器的核心逻辑、数据结构和叙事内容。它是项目四大支柱中的“大脑”，为所有后续的开发、设计和美术工作提供基础规则和内容脚本。

### 核心指导原则：

- **可行性第一 (Feasibility First)**: 我们采用基于规则的简化模型，而非复杂的学术级数学模型。所有逻辑都应能被清晰地翻译为代码中的 if-else 或状态机。

- **逻辑自洽 (Logical Consistency)**: 模型内的因果链条必须清晰、可信，能够直观地反映基础的生态学原理。

- **内容驱动 (Content-Driven)**: 所有的模拟规则最终都是为了服务于叙事和用户体验。

## 第一部分：简化生态模型 (The Ecological Model)

这部分定义了模拟世界运转的物理和生物法则。

### 2.1 核心状态变量 (Key State Variables)
我们将整个生态系统抽象为以下几个关键变量。所有变量均采用 0-100的标准化数值范围，这极大地简化了计算和前端显示（例如，可以直接映射为进度条的百分比）。

#### 时间单位:

- **tick (时间步长)**: 1 tick 代表 1个模拟月。这是我们进行所有计算的基本单位。

- **year (年份)**: 12 ticks。

#### 核心状态变量表

| 变量名 (Variable Name) | 分类 | 描述 | 初始值 (健康池塘) | 备注 |
|---|---|---|---|---|
| nutrients | 非生物 | 水体中的氮、磷等营养物质含量。是藻类和水生植物生长的关键。 | 20 | 农业径流会急剧增加此值。 |
| dissolvedOxygen | 非生物 | 水中溶解的氧气含量。是所有水生动物生存的基础。 | 80 | 藻类爆发后的分解过程会大量消耗此值。 |
| waterTurbidity | 非生物 | 水体浑浊度。影响阳光穿透，从而影响水生植物的光合作用。 | 15 | 藻类和悬浮物会增加此值。 |
| phytoplankton | 生产者 | 浮游植物（藻类）。生态系统的基础生产者。 | 25 | 营养物过高时会爆发式增长（水华）。 |
| aquaticPlants | 生产者 | 沉水或浮水植物。与藻类竞争营养，并为鱼类提供庇护和氧气。 | 60 | 对水体浊度敏感，需要阳光。 |
| zooplankton | 初级消费者 | 浮游动物。以浮游植物为食，是小型鱼类的主要食物。 | 30 | 随浮游植物数量波动。 |
| smallFish | 次级消费者 | 小型杂食性鱼类（如鳑鲏）。以浮游动物和植物碎屑为食。 | 50 | 对溶解氧非常敏感。 |
| largeFish | 三级消费者 | 大型肉食性鱼类（如鳜鱼）。以小型鱼类为食。 | 20 | 顶级捕食者，数量最少。 |
| decomposers | 分解者 | 细菌和真菌。分解死亡的有机物，消耗氧气，并将有机物转化为营养物质。 | 40 | 数量与死亡有机物总量正相关。 |

### 2.2 核心互动规则 (Core Interaction Rules)

在每个 tick (每月)，系统将根据以下规则顺序计算所有变量的变化。

#### A. 自然过程规则 (Natural Processes)

##### 生产者增长 (Producers Growth):

**phytoplankton (藻类):**
- 基础月增长: +5
- IF nutrients > 40 THEN 额外 +5 (营养充足)
- IF nutrients > 70 THEN 额外 +10 (营养过剩)
- IF aquaticPlants > 60 THEN -3 (来自水生植物的竞争)

**aquaticPlants (水生植物):**
- 基础月增长: +4
- IF nutrients > 30 THEN 额外 +3
- IF waterTurbidity > 50 THEN -5 (阳光不足)

##### 消费者互动 (Consumers Interaction):

**zooplankton (浮游动物):**
- 月变化 = (phytoplankton / 10) - (smallFish / 8)  (食物获取与被捕食)

**smallFish (小型鱼类):**
- 月变化 = (zooplankton / 10) - (largeFish / 10)
- IF dissolvedOxygen < 40 THEN 额外 -5 (缺氧压力)
- IF dissolvedOxygen < 20 THEN 额外 -15 (严重缺氧)

**largeFish (大型鱼类):**
- 月变化 = (smallFish / 12) - 2 (自然死亡)
- IF dissolvedOxygen < 30 THEN 额外 -8

##### 分解与循环 (Decomposition & Cycling):

计算“死亡有机物总量” deadOrganicMatter = (所有生物上个tick的死亡量总和，可以简化为一个估算值，例如 (100 - health_factor) / 5)。

decomposers 变化 = deadOrganicMatter / 10

nutrients 变化 = decomposers / 8 (分解者将有机物转化为营养物)

dissolvedOxygen 消耗 = decomposers / 5 (分解过程耗氧)

##### 环境变化 (Environmental Changes):

dissolvedOxygen 产出 = aquaticPlants / 8 + phytoplankton / 12 (光合作用产氧)

waterTurbidity 变化 = phytoplankton / 10 + nutrients / 20 (藻类和悬浮物导致浑浊)

#### B. 外部干预规则 (External Intervention - MVP)

事件：引入农业径流 (Introduce Agricultural Runoff)

效果： nutrients 一次性增加 +60。

触发： 用户在Stage 2点击按钮。

#### C. 修复工具规则 (Restoration Tools - MVP)

**工具：曝气机 (Activate Aerator)**
- 效果： 每个 tick，dissolvedOxygen +10。
- 触发： 用户在Stage 4启用。

**工具：种植河岸缓冲带 (Plant Riparian Buffer)**
- 效果： 每个 tick，nutrients -5 (模拟缓冲带对营养物的吸收)。
- 触发： 用户在Stage 4启用。

### 2.3 平衡与调整 (Balancing & Tuning)
重要提示： 以上所有数值均为初始设定。在开发过程中，最关键的工作之一就是反复测试和微调这些参数，直到模拟的行为符合预期（即：健康池塘能长期稳定，引入污染后能清晰地看到崩溃过程）。

## 第二部分：内容与叙事脚本 (Content & Narrative)

这部分负责与用户沟通，引导他们理解模拟并沉浸于故事中。

### 3.1 用户引导与教程脚本 (User Guidance Script)
#### 项目加载/初始界面:

欢迎来到“我的数字生物群系”。在这里，你将见证一个微缩世界的诞生、繁荣与挑战。

Stage 1: 观察者 (The Observer)

标题: 原始的和谐
内容: 这是一个健康、平衡的池塘生态系统。生命在此生生不息。请花些时间，静静观察它的自然节律。留意右侧的图表，它们是这个世界的“心跳”。

Stage 2: 干预者 (The Intervenor)

标题: 涟漪的中心
内容: 现在，你拥有了一次改变的力量。一个看似微小的决定，可能会掀起长达数十年的波澜。请从下方选择一项干预措施，引入你的池塘。
[按钮：引入农业径流]

Stage 3: 见证者 (The Witness)

标题: 时间的洪流
内容: 你的选择已经做出。现在，让我们加速时间，看看这个选择在未来50年里，将如何重塑这个世界...

Stage 4: 修复者 (The Restorer)

标题: 废墟上的希望
内容: 50年过去了，你的池塘已面目全非。生态的崩溃是毁灭性的，但修复的努力仍有希望。你现在可以使用一些工具来尝试逆转损害。但这会是一条漫长而艰难的道路。

### 3.2 事件日志脚本 (Event Log Script - 示例)

事件日志是增强叙事性的关键。它们应在满足特定条件时触发。

#### 事件日志表

| 触发条件 | 日志文本 |
|---|---|

| nutrients > 70 AND phytoplankton > 60 | [事件] 藻类水华爆发！ 水体中的藻类正以惊人的速度繁殖。 |
| waterTurbidity > 60 | [事件] 水体能见度下降。 阳光难以穿透浑浊的水体，水生植物的生存受到威胁。 |
| dissolvedOxygen < 40 | [警告] 水体开始缺氧。 鱼类和其他水生动物开始感到呼吸困难。 |
| aquaticPlants < 20 | [事件] 水生植物大面积死亡。 它们既是氧气的来源，也是许多生物的庇护所。 |
| smallFish < 10 | [灾难] 小型鱼类濒临灭绝。 食物链的一个关键环节已经断裂。 |
| largeFish < 5 | [灾难] 顶级捕食者消失。 池塘失去了它的“国王”。 |

### 3.3 术语解释库 (Glossary)

在UI中，当用户鼠标悬停在“营养物”、“溶解氧”等词上时，应显示简短的解释。

- **营养物 (Nutrients)**: 就像植物的“肥料”。适量是必须的，但过量（如来自农业径流的氮、磷）会导致藻类疯狂生长，引发一系列问题。

- **溶解氧 (Dissolved Oxygen)**: 鱼类和大多数水生生物在水下呼吸所依赖的氧气。它主要由水生植物的光合作用产生。大量的有机物分解会剧烈消耗它。

- **富营养化 (Eutrophication)**: 指水体中营养物含量过高，导致藻类和浮游生物过度繁殖，最终引起水质恶化和生态系统崩溃的过程。你引入的“农业径流”就是典型诱因。
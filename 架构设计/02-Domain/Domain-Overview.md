# 业务域总览（Domain Overview）

> 目标：把系统拆成若干个“业务域”，每个域边界清晰、职责单一。
> 原则：高内聚、低耦合；跨域通过“事件/接口”协作。

---

## 1. 业务域清单

### D1. 账号与身份（Auth）
**负责**
- 登录 / 注册 / 找回密码
- 验证码（短信/邮箱）
- Token / Session / Remember me
- 权限（普通用户 / 主办方 / 运营）

**不负责**
- 用户资料（昵称头像）属于 User 域
- 积分发放属于 Points 域

---

### D2. 用户资料（User）
**负责**
- 头像上传与裁剪后的保存（只存 URL）
- 昵称、性别、生日、家乡
- “我的”页面基础信息

**不负责**
- 登录态（Auth）
- 收藏点赞评论（Interaction）

---

### D3. 内容科普（Content）
**负责**
- 环保新闻 / 动态 / 政策 / 百科词条 的管理与展示
- 内容来源：运营手动上传 + 抓取入库
- 内容详情页

**不负责**
- 评论/点赞/收藏（Interaction）
- 搜索（Search，只提供可搜索数据）

---

### D4. 活动（Activity）
**负责**
- 活动列表、分类筛选、活动详情
- 两种来源：抓取（crawled） vs 本站发布（hosted）
- 本站活动报名（signup）与主办方报名统计
- 活动发布流程（模板化表单）

**不负责**
- 评论/点赞/收藏（Interaction）
- 推荐（Recommendation）

---

### D5. 互动（Interaction）
**负责**
- 评论 / 回复（树状结构）
- 点赞 / 收藏 / 踩踩（以及踩踩折叠逻辑）
- “最热/最新”排序所需的统计数据

**不负责**
- 积分规则（Points）
- 内容/活动本体数据（Content/Activity）

---

### D6. 积分与成长（Points）
**负责**
- 积分账户与积分流水
- 签到日历（连续签到、漏签）
- 每日任务（10点刷新、进度、领取）
- 每日问答（10点更新题目）
- 勋章墙（解锁进度、购买资格）

**不负责**
- 行为采集本体（Event）
- 评论点赞收藏（Interaction）

---

### D7. 搜索（Search）
**负责**
- 搜索框联想（suggest）
- 搜索预处理：拼音/简繁/大小写
- 全文搜索 + 模糊搜索
- 结果聚合：仅展示 活动 + 内容（新闻/动态/政策/词条）

**不负责**
- 内容生产（Content）
- 活动生产（Activity）

---

### D8. 行为事件（Event）
**负责**
- 记录用户行为：浏览、点赞、收藏、评论、报名、签到、完成游戏等
- 给 Points / Recommendation 提供统一数据来源
- 异步统计与风控基础

**不负责**
- 直接提供页面数据（由各业务域负责）

---

### D9. 推荐（Recommendation）
**负责**
- 每周个性推荐（基于用户行为）
- 每周最新推荐（按时间）
- 推荐结果缓存与更新策略

**不负责**
- 活动/内容存储（Activity/Content）

---

### D10. 数据采集（Crawler / Ingestion）
**负责**
- 定时抓取：小红书/公众号/环保官网（活动与内容）
- 去重、清洗、归一化
- 写入 Content / Activity 域的数据表
- 触发索引更新、触发推荐更新

**不负责**
- 对外 HTTP 接口（通常只跑 Worker）

---

## 2. 跨域协作方式（非常重要）

### 2.1 “写接口”协作（同步）
- 前端需要实时数据：User / Content / Activity / Interaction / Points / Search

### 2.2 “发事件”协作（异步）
- 用户行为 → Event（统一记录）
- Event → Points（推进任务进度、发积分）
- Event → Recommendation（更新推荐画像）
- Interaction →（异步）更新热度、计数
- Crawler → Search（更新索引）

---

## 3. 核心边界约束（架构规则）

- Content/Activity 不直接写入 Points
- Points 不反向调用 Interaction 计算数据
- 推荐只读数据，不修改业务数据
- 所有“可重算”的数据（计数、热度、推荐）都允许异步与重建
